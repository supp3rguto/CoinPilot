<header class="content-header">
  <h1>Gerenciador de Rotas</h1>
</header>

<div class="spinner-container" *ngIf="isLoading">
  <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
</div>

<div class="routes-layout" *ngIf="!isLoading">

  <div class="form-column">
    <h3>Adicionar Nova Rota</h3>

    <form [formGroup]="routeForm" (ngSubmit)="addRoute()" class="route-form">
      
      <label>Rota</label>
      <div class="origem-destino-wrapper">
        <mat-form-field appearance="outline">
          <mat-label>Origem</mat-label>
          <input matInput formControlName="origem" placeholder="Ex: Centro">
        </mat-form-field>

        <mat-icon>arrow_forward</mat-icon>

        <mat-form-field appearance="outline">
          <mat-label>Destino</mat-label>
          <input matInput formControlName="destino" placeholder="Ex: Aeroporto">
        </mat-form-field>
      </div>
      <mat-error *ngIf="(routeForm.get('origem')?.invalid && routeForm.get('origem')?.touched) || (routeForm.get('destino')?.invalid && routeForm.get('destino')?.touched)">
        Origem e Destino são obrigatórios.
      </mat-error>
      

      <mat-form-field appearance="outline" class="price-field">
        <mat-label>Preço Base (R$)</mat-label>
        <input matInput formControlName="basePrice" type="number" placeholder="Ex: 25.50">
        <mat-error *ngIf="routeForm.get('basePrice')?.hasError('required')">
          O preço é obrigatório.
        </mat-error>
      </mat-form-field>

      <button mat-flat-button color="primary" type="submit" [disabled]="routeForm.invalid">
        Adicionar Rota
      </button>

    </form>
  </div>

  <div class="table-column">
    <h3>Rotas Atuais no Simulador</h3>
    <table mat-table [dataSource]="routes" class="mat-elevation-z8">
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef> ID </th>
        <td mat-cell *matCellDef="let route"> {{route.id}} </td>
      </ng-container>
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef> Nome </th>
        <td mat-cell *matCellDef="let route"> {{route.name}} </td>
      </ng-container>
      <ng-container matColumnDef="basePrice">
        <th mat-header-cell *matHeaderCellDef> Preço Base </th>
        <td mat-cell *matCellDef="let route"> {{route.basePrice | currency:'BRL'}} </td>
      </ng-container>
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef> Ações </th>
        <td mat-cell *matCellDef="let route">
          <button mat-icon-button color="warn" (click)="deleteRoute(route.id)">
            <mat-icon>delete</mat-icon>
          </button>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>
</div>